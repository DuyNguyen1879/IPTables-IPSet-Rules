# Generated by iptables-save v1.4.12 on Fri Oct 30 20:59:30 2015
*nat
:PREROUTING ACCEPT [2:80]
:INPUT ACCEPT [2:80]
:OUTPUT ACCEPT [3:198]
:POSTROUTING ACCEPT [3:198]
COMMIT
# Completed on Fri Oct 30 20:59:30 2015
# Generated by iptables-save v1.4.12 on Fri Oct 30 20:59:30 2015
*mangle
:PREROUTING ACCEPT [87:6395]
:INPUT ACCEPT [87:6395]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [50:4502]
:POSTROUTING ACCEPT [50:4502]
COMMIT
# Completed on Fri Oct 30 20:59:30 2015
# Generated by iptables-save v1.4.12 on Fri Oct 30 20:59:30 2015
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [50:4502]
:BANNED_ACTIONS - [0:0]
:DDOS_ACTIONS - [0:0]
:DDOS_DETECT - [0:0]
:SPOOF_ACTIONS - [0:0]
:SPOOF_DETECT - [0:0]
:TOR_ACTIONS - [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -p tcp -m set --match-set BANNED_RANGES src -j BANNED_ACTIONS
-A INPUT -p tcp -m set --match-set TOR_IPS src -j TOR_ACTIONS
-A INPUT -j DDOS_DETECT
-A INPUT -j SPOOF_DETECT
-A INPUT -p tcp -m state --state NEW -m tcp -m multiport --dports 80,443 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -d 224.0.0.251/32 -p udp -m udp --dport 5353 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type any -j ACCEPT
-A INPUT -p esp -j ACCEPT
-A INPUT -p ah -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -j DDOS_ACTIONS
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A BANNED_ACTIONS -j REJECT --reject-with icmp-host-prohibited
-A DDOS_ACTIONS -p tcp -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "IPTABLES_DENIED_TCP: "
-A DDOS_ACTIONS -p udp -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "IPTABLES_DENIED_UDP: "
-A DDOS_ACTIONS -p icmp -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "IPTABLES_DENIED_ICMP: "
-A DDOS_ACTIONS -j REJECT --reject-with icmp-host-prohibited
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,ACK -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags PSH,ACK PSH -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags ACK,URG URG -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state NEW -j DDOS_ACTIONS
-A DDOS_DETECT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DDOS_ACTIONS
-A SPOOF_ACTIONS -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "IPTABLES_DENIED_SPOOF: "
-A SPOOF_ACTIONS -j REJECT --reject-with icmp-host-prohibited
-A SPOOF_DETECT -s 10.0.0.0/8 -j SPOOF_ACTIONS
-A SPOOF_DETECT -s 169.254.0.0/16 -j SPOOF_ACTIONS
-A SPOOF_DETECT -s 127.0.0.0/8 -j SPOOF_ACTIONS
-A SPOOF_DETECT -s 224.0.0.0/4 -j SPOOF_ACTIONS
-A SPOOF_DETECT -d 224.0.0.0/4 -j SPOOF_ACTIONS
-A SPOOF_DETECT -s 240.0.0.0/5 -j SPOOF_ACTIONS
-A SPOOF_DETECT -d 240.0.0.0/5 -j SPOOF_ACTIONS
-A SPOOF_DETECT -s 0.0.0.0/8 -j SPOOF_ACTIONS
-A SPOOF_DETECT -d 0.0.0.0/8 -j SPOOF_ACTIONS
-A SPOOF_DETECT -d 239.255.255.0/24 -j SPOOF_ACTIONS
-A SPOOF_DETECT -d 255.255.255.255/32 -j SPOOF_ACTIONS
-A TOR_ACTIONS -j REJECT --reject-with icmp-host-prohibited
COMMIT
# Completed on Fri Oct 30 20:59:30 2015
